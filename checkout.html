<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Checkout â€“ Starplanner</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:wght@400;600&display=swap" rel="stylesheet">

  <style>
    body {
      font-family:'Montserrat Alternates',sans-serif;
      margin:0;
      padding:0;
      background:#fff;
    }

    nav {
      background-image:url('ArtworkWaterverfkwastachterkopjes.jpg');
      background-repeat:no-repeat;
      background-position:center;
      background-size:120% 110%;
      padding:40px 60px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    nav ul {
      list-style:none;
      margin:0;
      padding:0;
      display:flex;
      gap:70px;
      padding-left:100px;
    }
    nav ul li a {
      text-decoration:none;
      color:white;
      font-size:18px;
      font-weight:600;
      text-shadow:1px 1px 3px rgba(0,0,0,0.3);
    }
    nav ul li a:hover { color:#FF7929; }

    .nav-icons { display:flex; gap:30px; align-items:center; position:relative; }
    .nav-icons img { width:36px; height:36px; cursor:pointer; }
    .cart-link { position:relative; }
    .cart-badge {
      position:absolute; top:-6px; right:-6px;
      background:#FF6F61; color:#fff; font-size:12px;
      font-weight:600; padding:2px 6px; border-radius:50%;
      min-width:18px; text-align:center;
    }

    main { padding:20px; max-width:900px; margin:0 auto; }
    h1 { color:#FFC90E; text-align:center; margin-top:30px; margin-bottom:10px; }
    .continue { color:#FFC90E; text-decoration:underline; text-align:center; cursor:pointer; }
    .cart-header { display:flex; justify-content:space-between; margin:40px 0 20px; color:#FFC90E; font-weight:600; font-size:16px; }
    .cart-item { display:flex; justify-content:space-between; align-items:center; padding:15px 0; border-bottom:1px solid #ddd; }
    .cart-item img { width:80px; height:auto; margin-right:20px; }
    .product-info { flex:1; }
    .remove { color:#FFC90E; text-decoration:underline; cursor:pointer; font-size:14px; margin-top:4px; }
    .qty-controls { display:flex; align-items:center; gap:5px; margin-top:5px; }
    .qty-btn { background:#FFC90E; border:none; color:#fff; font-size:16px; width:28px; height:28px; border-radius:4px; cursor:pointer; font-weight:bold; }
    .qty-box { min-width:40px; text-align:center; border:2px solid #FFC90E; padding:4px; border-radius:4px; font-weight:600; background:#fff; }
    .empty-cart { text-align:center; font-size:18px; color:#666; margin:40px 0; }
    .summary { margin-top:40px; font-size:18px; font-weight:600; color:#333; }
    .tax-note { font-size:14px; color:#FFC90E; font-weight:400; margin-top:4px; }
    .checkout-btn { display:inline-block; margin-top:20px; padding:16px 36px; background:#FFC90E; color:#fff; font-size:18px; font-weight:600; border:none; border-radius:6px; cursor:pointer; }
    .checkout-btn:hover { background:#e6b800; }

    footer { position:relative; margin-top:60px; overflow:hidden; }
    .footer-decoration { width:100%; height:100px; object-fit:cover; display:block; }
    .footer-text { position:absolute; bottom:10px; width:100%; text-align:center; color:#fff; font-size:14px; text-shadow:1px 1px 3px rgba(0,0,0,0.5); }

    /* ðŸŒŸ Stardust overlay */
    #stardust-overlay {
      display:flex;
      justify-content:center;
      align-items:center;
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,0.6);
      color:white;
      font-size:22px;
      font-weight:600;
      z-index:9999;
      flex-direction:column;
      overflow:hidden;
    }
    #stardust {
      position:absolute;
      width:100%;
      height:100%;
      top:0;
      left:0;
      overflow:hidden;
    }
    .star {
      position:absolute;
      border-radius:50%;
      background:radial-gradient(circle,#fffde7 0%,#ffffff 60%,rgba(255,255,255,0) 100%);
      box-shadow:0 0 6px 2px rgba(255,255,255,0.8);
      opacity:0;
      animation:twinkle 2s infinite ease-in-out;
      transform-origin:center;
    }
    @keyframes twinkle {
      0%,100% { opacity:0; transform:scale(1); }
      50% { opacity:1; transform:scale(1.6); }
    }
  </style>
</head>

<body>
  <!-- ðŸŒ  Stardust Loading Screen -->
  <div id="stardust-overlay">
    <div id="stardust"></div>
    <div>âœ¨ Sprinkling some stardust... âœ¨</div>
  </div>

  <header>
    <nav>
      <ul>
        <li><a href="index.html">HOME</a></li>
        <li><a href="thestorybehind.html">THE STORY BEHIND</a></li>
        <li><a href="shop.html">SHOP</a></li>
        <li><a href="plannertips.html">PLANNER TIPS</a></li>
        <li><a href="contact.html">CONTACT</a></li>
      </ul>

      <div class="nav-icons">
        <a href="account.html"><img src="user-icon.svg" alt="User"></a>
        <a href="checkout.html" class="cart-link">
          <img src="shoppingbag.svg" alt="Shopping Bag">
          <span id="cart-count" class="cart-badge">0</span>
        </a>
      </div>
    </nav>
  </header>

  <main>
    <h1>Your cart</h1>
    <div class="continue" onclick="window.location.href='shop.html'">Continue shopping</div>

    <div class="cart-header">
      <div>PRODUCT</div>
      <div>PRICE</div>
    </div>

    <div id="cart-items" class="cart-items"></div>

    <div class="summary">
      Subtotal: â‚¬<span id="subtotal">0.00</span>
      <div class="tax-note">Taxes and shipping calculated at checkout</div>
      <button class="checkout-btn" onclick="placeOrder()">Checkout</button>
    </div>
  </main>

  <footer>
    <img src="ArtworkWaterverfkwastfootheader.jpg" alt="Footer Decoration" class="footer-decoration">
    <div class="footer-text">Â© 2025 Starplanner â€“ All rights reserved.</div>
  </footer>

  <!-- âœ… Firebase compat SDK -->
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyApt-W5-Ag4Ov2JxVcudSrV4VL0zCBE8pc",
      authDomain: "starplanner-3acf9.firebaseapp.com",
      projectId: "starplanner-3acf9",
      storageBucket: "starplanner-3acf9.appspot.com",
      messagingSenderId: "793684440573",
      appId: "1:793684440573:web:5beb2ab6f64b4fc110d594"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const cartContainer = document.getElementById('cart-items');
    const subtotalEl = document.getElementById('subtotal');
    const cartCount = document.getElementById('cart-count');
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cartCount.textContent = cart.length;

    function renderCart() {
      cartContainer.innerHTML = '';
      let total = 0;
      if (cart.length === 0) {
        cartContainer.innerHTML = `<div class="empty-cart">Your cart is empty</div>`;
      } else {
        cart.forEach((item, index) => {
          const div = document.createElement('div');
          div.classList.add('cart-item');
          div.innerHTML = `
            <div style="display:flex; align-items:center;">
              <img src="shoppingbag.svg" alt="${item.name}">
              <div class="product-info">
                <div>${item.name}</div>
                <div class="remove" onclick="removeItem(${index})">REMOVE</div>
              </div>
            </div>
            <div>
              â‚¬${item.price.toFixed(2)} <br>
              <div class="qty-controls">
                <button class="qty-btn" onclick="updateQty(${index}, -1)">â€“</button>
                <span class="qty-box">${item.qty}</span>
                <button class="qty-btn" onclick="updateQty(${index}, 1)">+</button>
              </div>
            </div>
          `;
          cartContainer.appendChild(div);
          total += item.price * item.qty;
        });
      }
      subtotalEl.textContent = total.toFixed(2);
    }

    function removeItem(index) {
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart));
      cartCount.textContent = cart.length;
      renderCart();
    }

    function updateQty(index, delta) {
      cart[index].qty += delta;
      if (cart[index].qty < 1) cart[index].qty = 1;
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }

    async function placeOrder() {
      const user = auth.currentUser;
      if (!user) {
        alert("You must be logged in to complete your order.");
        return;
      }
      if (cart.length === 0) {
        alert("Your cart is empty.");
        return;
      }

      const totalAmount = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);

      try {
        await db.collection('orders').add({
          userId: user.uid,
          email: user.email,
          items: cart,
          total: totalAmount,
          date: firebase.firestore.FieldValue.serverTimestamp()
        });

        alert("âœ… Your order has been placed successfully!");
        localStorage.removeItem('cart');
        window.location.href = "account.html";
      } catch (error) {
        alert("âŒ Error placing order: " + error.message);
      }
    }

    renderCart();

    // âœ¨ Stardust generation script
    window.addEventListener('load', () => {
      const stardustContainer = document.getElementById('stardust');
      const overlay = document.getElementById('stardust-overlay');

      for (let i = 0; i < 30; i++) {
        const star = document.createElement('span');
        star.classList.add('star');
        const size = Math.random() * 2 + 1;
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        star.style.top = `${Math.random() * 100}%`;
        star.style.left = `${Math.random() * 100}%`;
        star.style.animationDelay = `${Math.random() * 2}s`;
        stardustContainer.appendChild(star);
      }

      setTimeout(() => {
        overlay.style.opacity = '0';
        overlay.style.transition = 'opacity 1s ease';
        setTimeout(() => overlay.style.display = 'none', 1000);
      }, 2500);
    });
  </script>

<!--
Apache serverconfiguratie voor caching en headers

<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
  Header set X-Content-Type-Options nosniff
  Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>
-->
</body>
</html>
